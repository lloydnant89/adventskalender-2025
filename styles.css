:root{
  --bg:#f0f5f7;
  --card:#fff;
  --accent:#8a1630;
  --accent-2:#000000;
  --muted:#56606a;
  --shadow: 0 8px 24px rgba(0,0,0,0.12);
  --stage-bg-size: cover;
  --door-opacity: 0.5; /* überschreibbar per JS via config */
  font-family: Inter, system-ui, -apple-system, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif;
}

*{box-sizing:border-box}
body{
  margin:0;
  background:linear-gradient(180deg,#fff 0%, var(--bg) 100%);
  color:#111;
  -webkit-font-smoothing:antialiased;
  -moz-osx-font-smoothing:grayscale;
  min-height:100vh;
  display:flex;
  align-items:center;
  justify-content:center;
  padding:1rem;
}

.page{
  width:100%;
  max-width:1200px;
}

.topbar{
  text-align:center;
  margin-bottom:0.25rem;
}

.topbar h1{
  margin:0;
  font-size:1.6rem;
}

.subtitle{
  margin:0.25rem 0;
  color:var(--muted);
  font-size:0.95rem;
}

/* Stage wrapper ensures a landscape aspect ratio suitable for tablets */
.stage-wrapper{
  display:flex;
  justify-content:center;
}

.stage{
  width:100%;
  max-width:1100px;
  aspect-ratio: 16 / 9;
  background-color: #f9f7f4;
  background-position: center;
  background-repeat: no-repeat;
  background-size: var(--stage-bg-size);
  position: relative;
  border-radius:12px;
  box-shadow:var(--shadow);
  overflow:hidden;
}

/* Tür-Elemente: absolut positioniert innerhalb der Stage.
   layout.json liefert top/left/width/height in Prozenten oder
   bei sequential layout werden Zellen berechnet */
.door{
  position:absolute;
  display:flex;
  align-items:center;
  justify-content:center;
  flex-direction:column;
  border-radius:10px;
  padding:6px;
  cursor:pointer;
  user-select:none;
  background: rgba(255,255,255,var(--door-opacity));
  border: 1px solid rgba(255,255,255,0.25);
  box-shadow: 0 6px 18px rgba(0,0,0,0.06);
  backdrop-filter: blur(4px) saturate(110%);
  min-width:40px;
  min-height:40px;
  text-align:center;
  overflow:hidden;
  z-index:10; /* ensure doors sit below the number overlays by default */
}

/* ensure readable numbers on variable backgrounds */
.door .num{
  font-size:1.25rem;
  font-weight:800;
  color:var(--accent-2);
  opacity:1; /* keine Transparenz */
  text-shadow: 0 5px 8px rgba(0, 0, 0, 0.966); /* dunklerer Schatten für Kontrast */
  -webkit-font-smoothing:antialiased;
  -moz-osx-font-smoothing:grayscale;
}
.door .caption{
  font-size:0.78rem;
  color:var(--muted);
  text-shadow: 0 1px 0 rgba(255,255,255,0.6);
}

/* Separate overlay for numbers so they are not affected by parent opacity */
.door-num{
  position:absolute;
  display:flex;
  align-items:center;
  justify-content:center;
  font-size:1.5rem;
  font-weight:800;
  color:var(--accent-2);
  opacity:1; /* keine Transparenz */
  text-shadow: 0 4px 8px rgb(255, 255, 255);
  z-index:55; /* high so numbers are always above doors */
  pointer-events:none; /* allow clicks to pass through to the door button */
}
/* if the door is locked we can visually dim the number too via a helper class */
.door-num.locked{ opacity:0.6; filter:grayscale(.02); }

/* Locked style */
.door.locked{
  opacity:0.55;
  filter:grayscale(.02);
  cursor:not-allowed;
}

/* Small visual badge when open */
.door .badge{
  position:absolute;
  top:6px;
  left:6px;
  background:var(--accent);
  color:white;
  padding:4px 6px;
  font-size:0.65rem;
  border-radius:6px;
  opacity:0;
  transition:opacity 180ms ease;
}

/* show badge for opened doors */
.door.opened .badge{ opacity:1; }

/* visual style for opened doors */
.door.opened{
  border-color: rgba(0,0,0,0.06);
  box-shadow: 0 8px 22px rgba(0,0,0,0.12);
}

/* hover/active */
.door:not(.locked):hover{
  transform: translateY(-4px);
  box-shadow: 0 10px 28px rgba(0,0,0,0.12);
}

/* Modal */
.modal{
  display:none;
  position:fixed;
  inset:0;
  background:rgba(0,0,0,0.45);
  align-items:center;
  justify-content:center;
  z-index:60;
}

.modal[aria-hidden="false"]{display:flex}

#modalTitle {
  white-space: pre-wrap;
  text-align: center;
  font-size:1.6rem;
  color:var(--accent);
  font-weight: 500;
}

.modal-content{
  width:95%;
  max-width:560px;
  background:var(--card);
  border-radius:12px;
  padding:16px;
  box-shadow:0 18px 40px rgba(0,0,0,0.25);
  position:relative;
}

.close{
  background:transparent;
  border:0;
  font-size:1.6rem;
  position:absolute;
  right:12px;
  top:8px;
  line-height:1;
  cursor:pointer;
}

.muted{color:var(--muted)}
#audioContainer audio{width:100%; margin-top:8px}

.footer{ margin-top:0.75rem; text-align:center; color:var(--muted); font-size:0.9rem; }

/* Responsive tweaks */
@media (max-width:700px){
  .stage{ aspect-ratio: 4 / 3; }
  .door .num{ font-size:1rem; }
}

/* Hidden reset trigger: bottom-right corner of the stage. Visible only when focused (for accessibility). */
/* .stage .reset-trigger{
  position:absolute;
  right:8px;
  bottom:8px;
  width:134px;
  height:134px;
  border:1px solid rgba(0,0,0,0.1);
  background:black;
  opacity:0.25; 
  padding:0;
  margin:0;
  z-index:9999;
  cursor:pointer;
} 
   */

.stage .reset-trigger{
  position:absolute;
  right:12px;
  bottom:12px;
  min-width:22px;
  height:10px;
  border: 1px dashed white;
  background: rgba(255,255,255,var(--door-opacity));
  color:var(--card);
  opacity:0.9; /* make visible for testing */
  padding:4px 8px;
  margin:0;
  z-index:9999;
  cursor:pointer;
  border-radius:6px;
  font-size:0.85rem;
  box-shadow: 0 6px 16px rgba(0,0,0,0.12);
}
.stage .reset-trigger:focus{
  outline:2px dashed rgba(255,255,255,0.4);
  opacity:1; /* fully visible on focus */
}